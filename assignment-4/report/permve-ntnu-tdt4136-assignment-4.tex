\input{../../../permve-ntnu-latex/assignment.tex}

\usepackage{float}
\usepackage{pgfplots, pgfplotstable}

\title{	
\normalfont \normalsize 
\textsc{Norwegian University of Science and Technology\\TDT4136 -- Introduction to Artificial Intelligence} \\ [25pt]
\horrule{0.5pt} \\[0.4cm]
\huge Assignment 4:\\ Simulated Annealing\\
\horrule{2pt} \\[0.5cm]
}

\author{Per Magnus Veierland\\permve@stud.ntnu.no}

\date{\normalsize\today}

\begin{document}

\maketitle

\begin{enumerate}
\item
The Python program \texttt{vi/app/egg\_carton/egg\_carton.py} is able to solve the egg carton problem through the use of the \texttt{simulated\_annealing} function from the \texttt{vi.search} namespace.
\item

For the egg carton puzzle each state consists of an M-by-N matrix of boolean values indicating whether a location contains an egg. Successor states are generated by toggling the value of a random location in the M-by-N matrix representing a state. Changing a single cell between neighboring states should keep their evaluations similar and assist the search by providing a smooth state search space.

The evaluation of egg carton states serves two purposes; validation and scoring. Toggling a random location in an egg carton state may produce an invalid successor state. The evaluation function sums the eggs of all rows, columns and diagonals, and verifies that none of these sums exceeds the number allowed ($K$). If the state is proved to be invalid the evaluation function returns a negative value indicating that the state cannot be used. The simulated annealing algorithm is implemented such that invalid neighbor states are never made current. For valid states the number of eggs is normalized against the upper boundary of eggs possible given the problem and returned. The upper boundary of eggs possible is given by $\min(M, N) \cdot K$.

\item Optimal solutions to all four puzzle variants are shown in figures~1-4. Table~\ref{table:sexymatrixes} shows how varying the temperature and delta temperature parameters affects the mean results achieved by the simulated annealing algorithm. It is apparent that low starting temperatures and low temperature deltas works well. Table~\ref{table:eggresults} shows the optimal solutions for all variants and the chance of producing an optimal solution for one algorithm run. Even for variant~4 an optimal solution can be found with $>99.9\%$ probability after 5 runs.

\begin{table}
\centering
\begin{tabular}{ccccc}
\toprule
Variant & $T$ & $\Delta T$ & Optimal solution & $P_{\textit{optimal}}$ \\
\midrule
1 & $0.1$ & $-0.000063$ & 10 & $0.9893$ \\
2 & $0.1$ & $-0.000047$ & 12 & $0.9767$ \\
3 & $0.1$ & $-0.000038$ &  8 & $0.9573$ \\
4 & $0.1$ & $-0.000011$ & 30 & $0.7805$ \\
\bottomrule
\end{tabular}
\caption{Egg carton results based on 10000 iterations for given parameters.}
\label{table:eggresults}
\end{table}

\newcommand{\displayeggcartonsolution}[4]{
    \begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{../data/egg-carton-best-scenario-#1.pdf}
    \caption{Optimal solution to egg carton variant \##1 ($M=#2$, $N=#3$, $K=#4$).}
    \end{figure}
}

\displayeggcartonsolution{1}{5}{5}{2}
\displayeggcartonsolution{2}{6}{6}{2}
\displayeggcartonsolution{3}{8}{8}{1}
\displayeggcartonsolution{4}{10}{10}{3}

\newcommand{\displayeggcartonparametermatrix}[1]{
    \begin{tikzpicture}[scale=0.7]
    \begin{axis}[view={0}{90},
        xlabel=Start Temperature,
        ylabel=Temperature Delta Ratio,
        colorbar,
        colorbar style={
            title=Value,
            yticklabel style={
                /pgf/number format/.cd,
                fixed,
                fixed zerofill
            }
        },
        title=Egg Carton: Variant #1 ]
    \addplot3[surf] file {../data/egg-carton-params-scenario-#1.txt};
    \end{axis}
    \end{tikzpicture}
}

\begin{table}
\centering
\begin{tabular}{cc}
\displayeggcartonparametermatrix{1} & \displayeggcartonparametermatrix{2} \\
\displayeggcartonparametermatrix{3} & \displayeggcartonparametermatrix{4} \\
\end{tabular}
\caption{Matrix plots showing average solution score for a given start temperature ($T$) and a delta temperature ratio (\textit{DTR}) where $\Delta T=\frac{T}{\textit{DTR}}$.}
\label{table:sexymatrixes}
\end{table}

\item
\begin{enumerate}
\item
A heuristic function is similar to an objective function in that they are both used to evaluate the ``goodness'' of a search node state. While a heuristic function evaluates an estimate of the cost from the state of a search node to a goal state; an objective function evaluates the optimality of a solution represented by the state of a search node.

With a heuristic function, the evaluation of a state represents the remaining path cost from the state to a goal state. This magnitude of this value must correspond to the actual path costs in the problem. The heuristic function can be used to guide an informed search which extends partial solutions to a complete path solution. An estimate of the total path cost ($f(x)$) of a solution passing through a given search state can be made by adding the path cost to reach the state ($g(x)$) with the heuristic for the state ($h(x)$). This value represents only an estimate of the total path cost of a solution with no guarantee that the search node evaluated will even be part of a possible solution path.

When performing local search the current search node state represents a complete solution. The objective function is used to describe the ``goodness'' of the solution described by the state. It should produce a value describing how close the given state is to a solution and/or how optimal that solution is. It is important that the objective function is able to provide granular feedback which can guide the search. Depending on the implementation of the simulated annealing algorithm the feedback from the objective function output should also be normalized.
\end{enumerate}

\end{enumerate}

\end{document}

